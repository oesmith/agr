<h1>News</h1>
<p>
  Fetched <%= time_ago_in_words(@scrape.updated_at) %> ago
  (<span class="news-state"><%= @scrape.state %></span>)
  <% if @scrape.state == 'errors' %><%= link_to "view", errors_news_path(id: @scrape.id) %><% end %>
</p>
<%= link_to 'Manage feeds', feeds_path, class: 'button' %>
<%= link_to 'Refresh', news_index_path, method: :post, class: 'button' %>
<% unless @scrape.previous.nil? %>
  <%= link_to 'Previous', news_path(@scrape.previous), class: 'button' %>
<% end %>

<div class="post-control-touch">
  <div class="post-prev">
    <svg class="post-control-icon" viewBox="0 0 20 20"><path d="M8.388,10.049l4.76-4.873c0.303-0.31,0.297-0.804-0.012-1.105c-0.309-0.304-0.803-0.293-1.105,0.012L6.726,9.516c-0.303,0.31-0.296,0.805,0.012,1.105l5.433,5.307c0.152,0.148,0.35,0.223,0.547,0.223c0.203,0,0.406-0.08,0.559-0.236c0.303-0.309,0.295-0.803-0.012-1.104L8.388,10.049z"></path></svg>
  </div>
  <div class="post-next">
    <svg class="post-control-icon" viewBox="0 0 20 20"><path d="M11.611,10.049l-4.76-4.873c-0.303-0.31-0.297-0.804,0.012-1.105c0.309-0.304,0.803-0.293,1.105,0.012l5.306,5.433c0.304,0.31,0.296,0.805-0.012,1.105L7.83,15.928c-0.152,0.148-0.35,0.223-0.547,0.223c-0.203,0-0.406-0.08-0.559-0.236c-0.303-0.309-0.295-0.803,0.012-1.104L11.611,10.049z"></path></svg>
  </div>
</div>

<% unless @scrape.state == 'pending' %>
  <% @scrape.posts.each_with_index do |post, index| %>
    <article>
      <h2 id="a<%= index + 1 %>">
        <%= post.title %>
      </h2>
      <p class="post-subtitle">
        <%= link_to "##{index + 1} / #{@scrape.posts.size}", "#a#{index + 1}" %> -
        <%= time_ago_in_words(post.published_at) %> ago - <%= link_to post.feed.name, post.link, target: "_blank" %>
        <% unless post == @scrape.posts.last %>- <a href="#a<%= index + 2 %>" data-turbolinks="false">skip &raquo;</a><% end %>
      </p>
      <%= sanitize_article(post.content) %>
    </article>
  <% end %>
<% end %>
